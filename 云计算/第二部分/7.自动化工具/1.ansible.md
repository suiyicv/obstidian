# 一.ansible介绍
基于python语言开发的，自动化运维工具
作用：批量管控
1.ansible特性
<span style="background:#affad1">轻量级工具</span>，salstack工具：重量级工具（分布式）
yum -y install ansible
缺点：支持的被管机的数量不多，顶多300
<span style="background:#affad1">底层基于ssh协议设计</span>的，这个也是轻量级的一种体现
你只要确保ansible服务器分为被管机能ssh连通就行了
他能管理Linux设备，也能管理支持ssh协议的window，网络设备等
<span style="background:#affad1">no server ; no agent</span>
管理机上只要把ansible安装好，不需要启动什么服务
<span style="background:#affad1">提供了丰富的api接口</span>
任何所谓的自动化工具，干的活都是你熟悉的活，无非就是换了一种操作方式
# 二.ansible的安装部署

## 1.配置所有机器免密
免密也可以不设置，根据公司要求来实现，免密危害性太大
ssh-keygen -t rsa
ssh-copy-id root@192.168.140.31
ssh-copy-id root@192.168.140.32
## 2.安装ansible
### 2.1 安装epel源
wget -O /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo
### 2.2安装ansible
yum -y install ansible
rpm -q ansible
![[Pasted image 20240625100853.png]]
## 3.配置主机清单文件
你想通过ansible操作谁，你要把被操作机的IP写到主机清单文件里面
vim /etc/ansible/hosts
主机清单文件的写法
192.168.140.31 
192.168.140.32
[web]
192.168.140.31
192.168.140.32
[db]
192.168.140.32
ansible all -m ping  # 测试和所以被管机之间的通讯的
![[Pasted image 20240625100957.png]]
ansible web -m ping
![[Pasted image 20240625101019.png]]
ansible db -m ping
![[Pasted image 20240625101030.png]]

## 4.添加非免密的主机
[db] 
192.168.140.32
<span style="background:#affad1">192.168.140.33</span>
### 4.1此时连接不上
![[Pasted image 20240625101205.png]]
### 4.2 配置非免密也能连接
ansible_ssh_user="root" ansible_ssh_pass="redhat" ansible_ssh_port=22
![[Pasted image 20240625101634.png]]
ansible db -m ping 
![[Pasted image 20240625101316.png]]
### 4.3 关闭检查公钥动作
ansible连接被管理机时，会在known_hosts文件中检测对方的key,可以修改ansible配置，把检查公钥的动作给关闭

vim /etc/ansible/ansible.cfg
	host_key_checking = False
![[Pasted image 20240625101507.png]]
ansible db -m ping 
![[Pasted image 20240625101527.png]]

# 三.ansible常用模块
## 1.ansible命令用法
ansible 被管理机 -m 模块名 -a 模块参数

## 2.常用模块














