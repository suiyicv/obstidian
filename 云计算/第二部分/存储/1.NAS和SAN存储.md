
# 一.存储设备
通过存储设备，为业务服务器提供更大的存储空间、更高的IO、共享存储
## 1.根据工作方式
DAS 直接附加存储
NAS 网络附加存储
SAN 存储区域网络
## 2.DAS 直接附加存储
通过数据总线直接将存储设备接入到主板上
磁盘类型：机械硬盘、SSD
磁盘接口：SATA，SAS、NVME
## 3.NAS存储
基于文件系统级别的共享
支持nfs、cifs协议共享存储空间
nfs：适用于Linux、Unix
cifs：适用于Windows

![[Pasted image 20240616215232.png|450]]
## 4.SAN存储
基于块级别的共享  
流程：存储端共享裸块设备，客户端连接存储映射出sdx的虚拟硬盘，客户端分区格式化挂载使用  
类型：IP SAN、FC SAN(光设备)
 
# 二.模拟配置SAN存储
## 1.创建虚拟机、安装openfiler
通过镜像安装openfiler系统
![[Pasted image 20240617022441.png|425]]
### 1.1浏览器访问
![[Pasted image 20240617030104.png|425]]
<span style="background:#affad1">用户名：openfiler， 密码：password</span>
![[Pasted image 20240617080913.png|425]]
## 2.创建RAID设备

![[Pasted image 20240617081228.png|700]]
## 3.初始化磁盘
![[Pasted image 20240617081414.png|700]]
所有的磁盘都搞成raid

## 4.创建raid
![[Pasted image 20240617081943.png]]

### 4.1创建raid10
![[Pasted image 20240617082128.png|725]]
## 5.开启iSCSI服务
![[Pasted image 20240617082448.png|750]]

## 6.配置SAN存储设备共享空间
![[Pasted image 20240617083005.png]]

### 6.1设置IQN
存储的共享名  
IQN名称格式: iqn.yyyy-mm.反域名:自定义名称
![[Pasted image 20240617083101.png]]

## 7.创建一个卷
![[Pasted image 20240617083850.png]]
### 7.1添加卷
![[Pasted image 20240617084117.png]]

![[Pasted image 20240617084220.png]]
### 7.2做个绑定
![[Pasted image 20240617084317.png]]
## 8.规划acl
![[Pasted image 20240617084723.png]]
## 9.用户认证
![[Pasted image 20240617084746.png]]


# 三.前端业务服务器使用sen存储

## 1 安装客户端软件
```bash
 yum install -y iscsi-initiator-utils 
```
## 2 编辑iscsid.conf配置文件，指定认证的用户
```bash
vim /etc/iscsi/iscsid.conf 
node.session.auth.authmethod = CHAP
node.session.auth.username = suiyi
node.session.auth.password = suiyi
```
## 3 探索存储
```bash
iscsiadm -m discovery -t st -p 192.168.140.128:3260 
iscsiadm: No portals found
```
首次探求存储时，存储端会生成拒绝所有客户端的文件，在存储端/etc/initiators.deny文件中删除拒绝所有条目，重新探索
```bash
 iscsiadm -m discovery -t st -p 192.168.140.128:3260 
192.168.140.128:3260,1 iqn.2024-06.com.linux:jf3-jg7-hw-db
```
## 4 连接使用存储
```bash
iscsiadm -m node -T iqn.2024-06.com.linux:jf3-jg7-hw-db -p 192.168.140.128:3260 -l
```
![[Pasted image 20240617085817.png]]
```bash
lsblk
```
![[Pasted image 20240617085834.png|602]]
```bash
 blkid /dev/sdb
```
 ![[Pasted image 20240617090025.png]]
```bash
vim /etc/fstab 
```
![[Pasted image 20240617090134.png]]
```bash
mount -a
df -hT
```
![[Pasted image 20240617090153.png|600]]

# 四.测试
```bash
touch /test1/{1..10}
ls /test1/
1  10  2  3  4  5  6  7  8  9
```


